
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Nothin' but .NET, Sydney 2009: Day 3 - dave^2 = -1</title>
  <meta name="author" content="David Tchepak">

  
  <meta name="description" content="Day 3 of Nothin&#8217; but .NET was a bit more laid back than previous days as we spent most of it in teams trying to apply some of the stuff we had &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://davesquared.net/2009/08/nothin-but-net-sydney-2009-day-3.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!-- MathJax config based on http://docs.mathjax.org/en/latest/config-files.html#the-mml-htmlormml-configuration-file
       (local mathjax derived from https://ro-che.info/articles/2017-04-02-deploying-mathjax) -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    config: ["MMLorHTML.js"],
    jax: ["input/MathML","output/HTML-CSS","output/NativeMML"],
    extensions: ["mml2jax.js"],
    "HTML-CSS": {
      availableFonts: ["TeX"],
      imageFont: null
    },
    MathMenu: {
       showRenderer: false,
       showFontMenu: false,
       showLocale: false
    }
  });
  </script>
  <script type="text/javascript" src="/javascripts/mathjax-2.7.0/MathJax.js"></script>
  <link href="http://feeds2.feedburner.com/davesquared" rel="alternate" title="dave^2 = -1" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2217573-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body  class="no-sidebar">
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds2.feedburner.com/davesquared" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<!-- Google CSE Search Box Begins  -->
<form id="searchbox_005697633880271604295:snlx0l0dwf0" action="http://www.google.com/cse" onsubmit="davesquared_submitSearchBoxWidget()">
  <fieldset role="search">
  <input value="005697633880271604295:snlx0l0dwf0" name="cx" type="hidden"/>
  <input value="" name="cof" type="hidden"/>
  <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<!-- Google CSE Search Box Ends -->
<script type="text/javascript">
function davesquared_submitSearchBoxWidget() {
  var searchBox = document.getElementById("searchbox_005697633880271604295:snlx0l0dwf0");
  searchBox.action = "/search";
  searchBox.cof.value="FORID:11";
}
</script>
  
<ul class="main-navigation">
  <li><a href="/" class="siteHome">dave^2 = -1</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/categories">Categories</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Nothin' but .NET, Sydney 2009: Day 3</h1>
    
    
      <p class="meta">
        








  



  

<time datetime="2009-08-08T22:51:00+10:00" pubdate data-updated="true">08 Aug 2009</time> 
      </p>
    
  </header>


<div class="entry-content"><p>Day 3 of <a href="http://www.jpboodhoo.com/training.oo">Nothin&#8217; but .NET</a> was a bit more laid back than previous days as we spent most of it in teams trying to apply some of the stuff we had learned. We had an early finish (10:45) in preparation for a longer day on Thursday. </p>

<p>I actually found this day immensely frustrating. After seeing so much cool stuff the previous two days and feeling like I was starting to understand the main concepts, it was completely demoralising to be given a fairly basic problem and utterly fail to make even the vaguest hint of progress with it. The only reason I didn&#8217;t feel completely incompetent was because of the overwhelming feeling of stupidity I had, and it didn&#8217;t feel quite right for someone so obviously stupid to think of a big word like &quot;incompetence&quot;. :\  :)</p>

<p>This wasn&#8217;t helped by the fact that as soon as JP started demonstrating how to proceed to the next stage, he made the solution seem so obvious and effortless. At the start of the course JP went to great lengths to encourage us not to compare ourselves to or compete with other developers, and that instead we should just aim to better ourselves one small step at a time. But in this case comparing JP&#8217;s work to mine wasn&#8217;t like comparing the work of two developers. It was more like comparing the works of <a href="http://en.wikipedia.org/wiki/Leonardo_da_vinci">Leonardo da Vinci</a> to those of a small, under-watered cabbage. It was fairly difficult not to notice the difference.</p>

<p>Despite this the under-watered cabbage did manage to pick up a few things from this day. First up I got to see an end-to-end, test-driven development of a Front Controller architecture for processing web requests using Commands. The Front Controller itself was more of a component &#8211; it consisted of several classes all grouped together to perform the front controller related tasks. It&#8217;s a bit like a &quot;layer&quot;, although the architecture wasn&#8217;t really layered in a traditional sense. It was just a bunch of components working together in a pretty loosely coupled way. Not having a more traditional layered approach seemed to make the design much more flexible.</p>

<div class="note"><b>Note:</b> As a source of examples for the following sections I&#8217;ll refer to a specific class within the Front Controller component &#8211; the slightly-confusingly named <code>FrontController</code> implementation (confusing because it is just one part of the entire Front Controller component). This class&#8217;s responsibility is to receive an <code>IncomingRequest</code> (an abstraction of an HTTP get or post) and run a <code>Command</code> that will do whatever this request is asking.</div>

<p>I also picked up a couple of TDD tips. The first was to start with a test case that reflects the simplest, most fundamental description of the subject under test&#8217;s (SUT&#8217;s) behaviour, rather than asserting little facts about the SUT. For example, when writing a test for when our <code>FrontController</code> is handling a request, we shouldn&#8217;t start by asserting it gets a non-null <code>Command</code> from its <code>CommandFactory</code>, or assert that <code>CommandFactory.Create()</code> was called on a mock object. Instead our test was that it &quot;should tell the command that can process the request to process it&quot;.</p>

<p>As I started picking up on later in the week, the former is really focussed on the mechanics of an implementation, while the latter is about the required behaviour. By being very descriptive about the behaviour, we end up driving out a lot of design in that one statement (in this case, the design decision is that we need a collaborator that can return a command that can process a request, and that our SUT will run that command). This technique also encourages the use of a very simple, targeted assertion in code, which lets us defer design decisions about the SUT&#8217;s dependencies until we start writing the context/SetUp method for the test.</p>

<p>This really comes down to the identification and segregation of responsibilities (as per the <a href="http://davesquared.net/2009/01/introduction-to-solid-principles-of-oo.html">Single Responsibility Principle (SRP)</a>). This process is really helped by attempting to identify the most abstract responsibilities beneath the SUT, while ensuring the SUT is still responsible for adding some behaviour. Or, put another way, the SUT should have only one small part to play in achieving it&#8217;s overall reason for existence &#8211; this is its single responsibility. Everything else is deferred to the implementation of its collaborators.</p>

<p>Another TDD technique JP used was doing the &quot;simplest thing that makes sense&quot;, instead of the &quot;simplest thing that could possibly work&quot;. For the <code>FrontController</code> example, the simplest thing that could work when initially coding it would be injecting a single <code>Command</code> into the <code>FrontController</code> and asserting that the command was run. Then what? Move on to another SUT and leave a very defficient implementation of our <code>FrontController</code>? In this case, we know with absolute certainty that this class will need to process more than one type of <code>Command</code>, so the simplest thing that makes sense is for the <code>FrontController</code> to get a relevant command implementation from a <code>CommandRegistry</code> or similar type, rather than hard-wiring in a single command. This not only gives our <code>FrontController</code> less reasons to change (as per the <a href="http://davesquared.net/2009/01/introduction-to-solid-principles-of-oo.html">Open Closed Principle (OCP)</a>), but it also points out the next SUT we can drive out, the <code>CommandRegistry</code> implementation.</p>

<div class="note"><b>Aside:</b> In retrospect, we could potentially get the same design in a more incremental fashion by still doing the simplest thing that will work but being especially diligent during the refactoring step of TDD. Just say our first attempt was to inject a single <code>Command</code> and assert it&#8217;s run method was called. The test passes, and the next step is to look for refactoring opportunities. We notice the OCP violation, and refactor to introduce the <code>CommandFactory</code>, all under the protective cover of our passing test. I have a suspicion that it might be more reliable to think about the problem in abstract terms and have a <a href="http://davesquared.net/2009/01/introduction-to-solid-principles-of-oo.html">SOLID</a> design naturally fall out than to do the simplest thing that could work, and then run it through the gauntlet of SOLID principles, <a href="http://en.wikipedia.org/wiki/GRASP_%28Object_Oriented_Design%29">GRASP patterns</a> etc. Still, I find it comforting that if I miss the abstraction up front I still have a chance to get there via refactoring.</div>

<h2>Other tidbits</h2>

<p>Here is some other stuff that came up during day 3:</p>

<ul>
<li>A long context/SetUp for a test is a test smell that indicates we&#8217;re probably doing too much. Push some of it down into other collaborators so we can defer decisions about it.</li>
<li>Creating something is a responsibility. If a SUT needs to create something and act on it, then the creation should probably be pushed out into a Factory. The SUT is then only responsible for using the factory and its output (i.e. mediating between the two types).</li>
<li>When designing and writing tests, focus on abstraction and intention rather than focussing on implementation and mechanics. Yes, I&#8217;ve written this already in this post. No, I probably haven&#8217;t stressed it enough. </li>
<li>If stubbed values are required for a test to work then these are tested implicitly when the test runs. In our <code>FrontController</code> example where it uses a <code>CommandRegistry</code> to get a <code>Command</code> and call its <code>Run()</code> method, we don&#8217;t need to explicitly test that <code>CommandRegistry.Create()</code> was called. Instead we can stub out <code>Create()</code> to return a specific <code>Command</code> instance, and assert that its <code>Run()</code> method was called. We don&#8217;t need to explicitly assert that the factory was used if the test&#8217;s assertion already depends on it. This is a side-effect of identifying the simplest, fundamental assertion for a SUT rather than thinking about the implementation mechanics.</li>
<li>By constraining ourselves to one ViewModel per View we can use convention over configuration to wire everything up.</li>
<li>Went through the concept of a Service Layer, which is a type of Facade for operating on the domain.</li>
<li>Went over Command Query Separation (CQS)</li>
<li>Covered <a href="Separated Interface - implementation lives at a lower level than interface http://martinfowler.com/eaaCatalog/separatedInterface.html">Separated Interface</a>, where an implementation lives at a lower level than the interface itself. An example is a <code>Query</code> interface which is defined somewhere with visibility from all layers/components, but the implementation within the domain or by the ORM or persistence layer/component. This is why its ok to use NHibernate&#8217;s criteria interfaces from pretty much anywhere within the application, provided the implementation is abstracted appropriately into a lower layer. The <a href="http://davesquared.net/2009/01/introduction-to-solid-principles-of-oo.html">Dependency Inversion Principle (DIP)</a> is used as a guide for applying the Separated Interface pattern (i.e. higher levels should not depend upon lower levels, but instead on interfaces using the Separated Interface pattern).</li>
</ul>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David Tchepak</span></span>

      








  



  

<time datetime="2009-08-09T00:27:40+10:00" class="updated">Updated 09 Aug 2009</time>
      

<span class="categories">
  
    <a class='category' href='/categories/-nbdn/'>+nbdn</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://davesquared.net/2009/08/nothin-but-net-sydney-2009-day-3.html" data-via="" data-counturl="http://davesquared.net/2009/08/nothin-but-net-sydney-2009-day-3.html" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2009/08/nothin-but-net-sydney-2009-day-2.html" title="Previous Post: Nothin' but .NET, Sydney 2009: Day 2">&laquo; Nothin' but .NET, Sydney 2009: Day 2</a>
      
      
        <a class="basic-alignment right" href="/2009/08/nothin-but-net-sydney-2009-day-4.html" title="next Post: Nothin' but .NET, Sydney 2009: Day 4">Nothin' but .NET, Sydney 2009: Day 4 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

    </div>
  </div>
  <footer role="contentinfo"><p class="disclaimer">All code and advice is provided without warranty -- use at your own risk! This is just a blog! Don't take it too seriously!<br/>
Despite not being too serious, this blog has a <a href="http://davesquared.net/2007/07/privacy-policy.html">Privacy Policy</a>, because it uses Google Analytics to see if anyone drops by.</p>
<p>
  Copyright &copy; 2022 - David Tchepak -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

  
<script type="text/javascript">
      var disqus_shortname = 'davesquared';
        // var disqus_developer = 1;
        var disqus_identifier = 'http://davesquared.net/2009/08/nothin-but-net-sydney-2009-day-3.html';
        var disqus_url = 'http://davesquared.net/2009/08/nothin-but-net-sydney-2009-day-3.html';
        var disqus_script = 'embed.js';
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
